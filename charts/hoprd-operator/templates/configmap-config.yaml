
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "hoprd-operator.fullname" . }}-config
  namespace: {{ .Release.Namespace | quote }}
  labels:
    {{- include "hoprd-operator.labels" . | nindent 4 }}
    {{- if .Values.operator.commonLabels }}
    {{- .Values.operator.commonLabels | toYaml | nindent 4 }}
    {{- end }}
{{- if .Values.operator.commonAnnotations }}
  annotations:
    {{- .Values.operator.commonAnnotations | toYaml | nindent 4 }}
{{- end }}
data:
  config.yaml: |
    instance:
      name: {{ include "hoprd-operator.fullname" . | quote }}
      namespace: {{ .Release.Namespace | quote }}
    {{- if .Values.operator.secretName }}
      secret_name: "{{- .Values.operator.secretName }}"
    {{- else }}
      secret_name: "{{ include "hoprd-operator.fullname" . }}"
    {{- end }}
    ingress:
      ingress_class_name: "{{- .Values.operator.ingress.ingressClassName }}"
      dns_domain: "{{- .Values.operator.ingress.dnsDomain }}"
      namespace: "{{- .Values.operator.ingress.namespace }}"
      p2p_port_min: "{{ .Values.operator.ingress.p2pPorts.min | quote }}"
      p2p_port_max: "{{ .Values.operator.ingress.p2pPorts.max | quote }}"
      selector_labels: {{- .Values.operator.ingress.selectorLabels | toYaml | nindent 8 }}
      annotations: {{- .Values.operator.ingress.annotations | toYaml | nindent 8 }}
    hopli_image: {{ printf "%s/%s:%s" .Values.operator.hopli.registry .Values.operator.hopli.repository .Values.operator.hopli.tag | quote }}
    persistence:
      size: "{{- .Values.operator.persistence.size }}"
      storage_class_name:  "{{- .Values.operator.persistence.storageClassName }}"

    
